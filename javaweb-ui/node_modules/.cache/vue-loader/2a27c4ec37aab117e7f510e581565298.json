{"remainingRequest":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\JavaWebVue\\javaweb-ui\\src\\views\\generator\\gentable\\editTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\JavaWebVue\\javaweb-ui\\src\\views\\generator\\gentable\\editTable.vue","mtime":1619428986000},{"path":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBiYXNpY0luZm9Gb3JtIGZyb20gIi4vYmFzaWNJbmZvRm9ybSI7CmltcG9ydCBnZW5JbmZvRm9ybSBmcm9tICIuL2dlbkluZm9Gb3JtIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiR2VuRWRpdCIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRhYmxlTG9hZGluZzogZmFsc2UsCiAgICAgIHN1Ym1pdExvYWRpbmc6IGZhbHNlLAogICAgICAvLyDpgInkuK3pgInpobnljaHnmoQgbmFtZQogICAgICBhY3RpdmVOYW1lOiAiY2xvdW0iLAogICAgICAvLyDooajmoLznmoTpq5jluqYKICAgICAgdGFibGVIZWlnaHQ6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQgLSAxODAgKyAicHgiLAogICAgICAvLyDooajliJfkv6Hmga8KICAgICAgY2xvdW1uczogW10sCiAgICAgIC8vIOWtl+WFuOS/oeaBrwogICAgICBkaWN0T3B0aW9uczogW10sCiAgICAgIC8vIOihqOivpue7huS/oeaBrwogICAgICBpbmZvOiB7fSwKICAgICAgZGlyZWN0aW9uOiAncnRsJywKICAgIH07CiAgfSwKICBwcm9wczogewogICAgdmlzaWJsZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIHRhYmxlSWQ6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiAwOwogICAgICB9CiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7YmFzaWNJbmZvRm9ybSxnZW5JbmZvRm9ybX0sCiAgY29tcHV0ZWQ6IHsKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldFRhYmxlSW5mbygpOwogIH0sCiAgbWV0aG9kczogewogICAgLyoqCiAgICAgKiDojrflj5booajor6bmg4UKICAgICAqLwogICAgZ2V0VGFibGVJbmZvKCkgewogICAgICB0aGlzLnRhYmxlTG9hZGluZyA9IHRydWUKICAgICAgdGhpcy4kaHR0cC5nZXQoJy9nZW50YWJsZS9nZXRUYWJsZUluZm8vJyArIHRoaXMudGFibGVJZCkKICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmNsb3VtbnMgPSByZXMuZGF0YS5kYXRhLnJlY29yZHM7CiAgICAgICAgdGhpcy5pbmZvID0gcmVzLmRhdGEuZGF0YS5pbmZvOwogICAgICAgIHRoaXMudGFibGVMb2FkaW5nID0gZmFsc2U7CiAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgIHRoaXMuY2xvdW1ucyA9IFtdOwogICAgICAgIHRoaXMuaW5mbyA9IHt9OwogICAgICAgIHRoaXMudGFibGVMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlLm1lc3NhZ2UpOwogICAgICB9KTsKICAgIH0sCgogICAgLyoqCiAgICAgKiDmj5DkuqTooajljZUKICAgICAqLwogICAgc3VibWl0Rm9ybSgpIHsKICAgICAgdGhpcy5zdWJtaXRMb2FkaW5nID0gdHJ1ZTsKICAgICAgY29uc3QgYmFzaWNGb3JtID0gdGhpcy4kcmVmcy5iYXNpY0luZm8uJHJlZnMuYmFzaWNJbmZvRm9ybTsKICAgICAgY29uc3QgZ2VuRm9ybSA9IHRoaXMuJHJlZnMuZ2VuSW5mby4kcmVmcy5nZW5JbmZvRm9ybTsKICAgICAgUHJvbWlzZS5hbGwoW2Jhc2ljRm9ybSwgZ2VuRm9ybV0ubWFwKHRoaXMuZ2V0Rm9ybVByb21pc2UpKS50aGVuKHJlcyA9PiB7CiAgICAgICAgY29uc3QgdmFsaWRhdGVSZXN1bHQgPSByZXMuZXZlcnkoaXRlbSA9PiAhIWl0ZW0pOwogICAgICAgIGlmICh2YWxpZGF0ZVJlc3VsdCkgewogICAgICAgICAgY29uc3QgZ2VuVGFibGUgPSBPYmplY3QuYXNzaWduKHt9LCBiYXNpY0Zvcm0ubW9kZWwsIGdlbkZvcm0ubW9kZWwpOwogICAgICAgICAgZ2VuVGFibGUuY29sdW1ucyA9IHRoaXMuY2xvdW1uczsKICAgICAgICAgIGdlblRhYmxlLnBhcmFtcyA9IHsKICAgICAgICAgICAgdHJlZUNvZGU6IGdlblRhYmxlLnRyZWVDb2RlLAogICAgICAgICAgICB0cmVlTmFtZTogZ2VuVGFibGUudHJlZU5hbWUsCiAgICAgICAgICAgIHRyZWVQYXJlbnRDb2RlOiBnZW5UYWJsZS50cmVlUGFyZW50Q29kZQogICAgICAgICAgfTsKICAgICAgICAgIC8vIOabtOaWsOS4muWKoeihqAogICAgICAgICAgdGhpcy4kaHR0cC5wdXQoJy9nZW50YWJsZS91cGRhdGVHZW5UYWJsZScsZ2VuVGFibGUpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMuZGF0YS5tc2csCiAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuc3VibWl0TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLiRlbWl0KCJyZXR1cm5CYWNrIik7CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKGUgPT4gewogICAgICAgICAgICB0aGlzLnN1Ym1pdExvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlLm1lc3NhZ2UpOwogICAgICAgICAgfSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5zdWJtaXRMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLkuJrliqHooajmm7TmlrDlpLHotKUiKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGdldEZvcm1Qcm9taXNlKGZvcm0pIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgIGZvcm0udmFsaWRhdGUocmVzID0+IHsKICAgICAgICAgIHJlc29sdmUocmVzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLyoqCiAgICAgKiDlhbPpl63pobXpnaIKICAgICAqLwogICAgaGFuZGxlQ2xvc2UoaGlkZSkgewogICAgICBpZiAoaGlkZSkgewogICAgICAgIGhpZGUoKTsKICAgICAgfQogICAgICB0aGlzLiRlbWl0KCJyZXR1cm5CYWNrIik7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["editTable.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmHA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"editTable.vue","sourceRoot":"src/views/generator/gentable","sourcesContent":["<template>\r\n  <el-drawer\r\n    class=\"edit-table\"\r\n    title=\"编辑\"\r\n    :visible.sync=\"visible\"\r\n    :direction=\"direction\"\r\n    :size=\"'calc(100vw - 256px)'\"\r\n    :before-close=\"handleClose\"\r\n  >\r\n    <el-card shadow=\"never\" body-style=\"position:relative;padding:0;\" style=\"margin:5px 20px;\">\r\n      <el-tabs v-model=\"activeName\" class=\"demo-icon-tabs\">\r\n        <el-tab-pane label=\"基本信息\" name=\"basic\">\r\n          <basic-info-form ref=\"basicInfo\" :info=\"info\" />\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"字段信息\" name=\"cloum\" style=\"margin-top:10px;\">\r\n          <el-table size=\"medium\" v-loading=\"tableLoading\" :data=\"cloumns\" :max-height=\"tableHeight\">\r\n            <el-table-column label=\"编号\" type=\"index\" width=\"60\" />\r\n            <el-table-column prop=\"columnName\" label=\"字段列名\" :show-overflow-tooltip=\"true\" min-width=\"10%\"/>\r\n            <el-table-column label=\"字段描述\" min-width=\"10%\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input v-model=\"scope.row.columnComment\"></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"columnType\" label=\"数据类型\" :show-overflow-tooltip=\"true\" min-width=\"10%\"/>\r\n            <el-table-column label=\"字段类型\" min-width=\"11%\">\r\n              <template slot-scope=\"scope\">\r\n                <el-select v-model=\"scope.row.javaType\">\r\n                  <el-option label=\"Long\" value=\"Long\" />\r\n                  <el-option label=\"String\" value=\"String\" />\r\n                  <el-option label=\"Integer\" value=\"Integer\" />\r\n                  <el-option label=\"Double\" value=\"Double\" />\r\n                  <el-option label=\"BigDecimal\" value=\"BigDecimal\" />\r\n                  <el-option label=\"Date\" value=\"Date\" />\r\n                </el-select>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"字段属性\" min-width=\"10%\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input v-model=\"scope.row.javaField\"></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"插入\" min-width=\"5%\">\r\n              <template slot-scope=\"scope\">\r\n                <el-checkbox true-label=\"1\" v-model=\"scope.row.isInsert\"></el-checkbox>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"编辑\" min-width=\"5%\">\r\n              <template slot-scope=\"scope\">\r\n                <el-checkbox true-label=\"1\" v-model=\"scope.row.isEdit\"></el-checkbox>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"列表\" min-width=\"5%\">\r\n              <template slot-scope=\"scope\">\r\n                <el-checkbox true-label=\"1\" v-model=\"scope.row.isList\"></el-checkbox>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"查询\" min-width=\"5%\">\r\n              <template slot-scope=\"scope\">\r\n                <el-checkbox true-label=\"1\" v-model=\"scope.row.isQuery\"></el-checkbox>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"查询方式\" min-width=\"10%\">\r\n              <template slot-scope=\"scope\">\r\n                <el-select v-model=\"scope.row.queryType\">\r\n                  <el-option label=\"=\" value=\"EQ\" />\r\n                  <el-option label=\"!=\" value=\"NE\" />\r\n                  <el-option label=\">\" value=\"GT\" />\r\n                  <el-option label=\">=\" value=\"GTE\" />\r\n                  <el-option label=\"<\" value=\"LT\" />\r\n                  <el-option label=\"<=\" value=\"LTE\" />\r\n                  <el-option label=\"LIKE\" value=\"LIKE\" />\r\n                  <el-option label=\"BETWEEN\" value=\"BETWEEN\" />\r\n                </el-select>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"必填\" min-width=\"5%\">\r\n              <template slot-scope=\"scope\">\r\n                <el-checkbox true-label=\"1\" v-model=\"scope.row.isRequired\"></el-checkbox>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"显示类型\" min-width=\"12%\">\r\n              <template slot-scope=\"scope\">\r\n                <el-select v-model=\"scope.row.htmlType\">\r\n                  <el-option label=\"文本框\" value=\"input\" />\r\n                  <el-option label=\"文本域\" value=\"textarea\" />\r\n                  <el-option label=\"下拉框\" value=\"select\" />\r\n                  <el-option label=\"单选框\" value=\"radio\" />\r\n                  <el-option label=\"复选框\" value=\"checkbox\" />\r\n                  <el-option label=\"日期控件\" value=\"datetime\" />\r\n                </el-select>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"生成信息\" name=\"genInfo\">\r\n          <gen-info-form ref=\"genInfo\" :info=\"info\" />\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n    </el-card>\r\n      <el-form label-width=\"100px\">\r\n        <el-form-item style=\"text-align: center;margin-left:-100px;margin-top:10px;\">\r\n          <el-button\r\n                    :loading=\"submitLoading\"\r\n                    @click=\"submitForm()\"\r\n                    type=\"primary\"\r\n                    size=\"medium\"\r\n            >确定提交\r\n            </el-button>\r\n          <el-button @click=\"$emit('returnBack')\" size=\"medium\">返回</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n  </el-drawer>\r\n</template>\r\n\r\n<script>\r\n  import basicInfoForm from \"./basicInfoForm\";\r\n  import genInfoForm from \"./genInfoForm\";\r\n\r\n  export default {\r\n    name: \"GenEdit\",\r\n    data() {\r\n      return {\r\n        tableLoading: false,\r\n        submitLoading: false,\r\n        // 选中选项卡的 name\r\n        activeName: \"cloum\",\r\n        // 表格的高度\r\n        tableHeight: document.documentElement.scrollHeight - 180 + \"px\",\r\n        // 表列信息\r\n        cloumns: [],\r\n        // 字典信息\r\n        dictOptions: [],\r\n        // 表详细信息\r\n        info: {},\r\n        direction: 'rtl',\r\n      };\r\n    },\r\n    props: {\r\n      visible: {\r\n        type: Boolean,\r\n        default() {\r\n          return false;\r\n        }\r\n      },\r\n      tableId: {\r\n        type: Number,\r\n        default() {\r\n          return 0;\r\n        }\r\n      }\r\n    },\r\n    components: {basicInfoForm,genInfoForm},\r\n    computed: {\r\n    },\r\n    mounted() {\r\n      this.getTableInfo();\r\n    },\r\n    methods: {\r\n      /**\r\n       * 获取表详情\r\n       */\r\n      getTableInfo() {\r\n        this.tableLoading = true\r\n        this.$http.get('/gentable/getTableInfo/' + this.tableId)\r\n        .then(res => {\r\n          this.cloumns = res.data.data.records;\r\n          this.info = res.data.data.info;\r\n          this.tableLoading = false;\r\n        }).catch(e => {\r\n          this.cloumns = [];\r\n          this.info = {};\r\n          this.tableLoading = false;\r\n          this.$message.error(e.message);\r\n        });\r\n      },\r\n\r\n      /**\r\n       * 提交表单\r\n       */\r\n      submitForm() {\r\n        this.submitLoading = true;\r\n        const basicForm = this.$refs.basicInfo.$refs.basicInfoForm;\r\n        const genForm = this.$refs.genInfo.$refs.genInfoForm;\r\n        Promise.all([basicForm, genForm].map(this.getFormPromise)).then(res => {\r\n          const validateResult = res.every(item => !!item);\r\n          if (validateResult) {\r\n            const genTable = Object.assign({}, basicForm.model, genForm.model);\r\n            genTable.columns = this.cloumns;\r\n            genTable.params = {\r\n              treeCode: genTable.treeCode,\r\n              treeName: genTable.treeName,\r\n              treeParentCode: genTable.treeParentCode\r\n            };\r\n            // 更新业务表\r\n            this.$http.put('/gentable/updateGenTable',genTable).then(res => {\r\n              this.$message({\r\n                  message: res.data.msg,\r\n                  type: \"success\"\r\n              });\r\n              this.submitLoading = false;\r\n              this.$emit(\"returnBack\");\r\n            })\r\n            .catch(e => {\r\n              this.submitLoading = false;\r\n              this.$message.error(e.message);\r\n            })\r\n          } else {\r\n            this.submitLoading = false;\r\n            this.$message.error(\"业务表更新失败\");\r\n          }\r\n        });\r\n      },\r\n      getFormPromise(form) {\r\n        return new Promise(resolve => {\r\n          form.validate(res => {\r\n            resolve(res);\r\n          });\r\n        });\r\n      },\r\n      /**\r\n       * 关闭页面\r\n       */\r\n      handleClose(hide) {\r\n        if (hide) {\r\n          hide();\r\n        }\r\n        this.$emit(\"returnBack\");\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style scoped>\r\n/* 选项卡 */\r\n.demo-icon-tabs >>> .el-tabs__nav-scroll {\r\n  padding: 0 20px;\r\n}\r\n\r\n.demo-icon-tabs >>> .el-tabs__item {\r\n  height: 45px;\r\n  line-height: 45px;\r\n}\r\n</style>\r\n"]}]}