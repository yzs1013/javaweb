{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-2d0bd75c\"],{\"2ba7\":function(e,t,l){\"use strict\";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l(\"div\",{staticClass:\"ele-body\"},[l(\"el-card\",{attrs:{shadow:\"never\"}},[l(\"el-form\",{staticClass:\"ele-form-search\",attrs:{model:e.table.where,\"label-width\":\"77px\"},nativeOn:{keyup:function(t){return!t.type.indexOf(\"key\")&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?null:e.$refs.table.reload()},submit:function(e){e.preventDefault()}}},[l(\"el-row\",{attrs:{gutter:15}},[l(\"el-col\",{attrs:{md:6,sm:12}},[l(\"el-form-item\",{attrs:{label:\"用户账号:\"}},[l(\"el-input\",{attrs:{placeholder:\"请输入用户账号\",clearable:\"\"},model:{value:e.table.where.username,callback:function(t){e.$set(e.table.where,\"username\",t)},expression:\"table.where.username\"}})],1)],1),l(\"el-col\",{attrs:{md:6,sm:12}},[l(\"div\",{staticClass:\"ele-form-actions\"},[l(\"el-button\",{staticClass:\"ele-btn-icon\",attrs:{type:\"primary\",icon:\"el-icon-search\"},on:{click:function(t){return e.$refs.table.reload()}}},[e._v(\"查询 \")]),e.permission.includes(\"sys:loginlog:export\")?l(\"el-button\",{staticClass:\"ele-btn-icon\",attrs:{icon:\"el-icon-download\",type:\"success\"},on:{click:e.exportData}},[e._v(\"导出日志\")]):e._e()],1)])],1)],1),l(\"ele-data-table\",{ref:\"table\",attrs:{config:e.table,height:\"calc(100vh - 260px)\",\"highlight-current-row\":\"\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.index;return[l(\"el-table-column\",{attrs:{type:\"index\",index:a,label:\"编号\",width:\"60\",align:\"center\",fixed:\"left\",\"show-overflow-tooltip\":\"\"}}),l(\"el-table-column\",{attrs:{prop:\"title\",label:\"日志标题\",align:\"center\",\"show-overflow-tooltip\":\"\",\"min-width\":\"110\"}}),l(\"el-table-column\",{attrs:{prop:\"username\",label:\"登录账号\",align:\"center\",\"show-overflow-tooltip\":\"\",\"min-width\":\"110\"}}),l(\"el-table-column\",{attrs:{prop:\"loginIp\",label:\"登录IP\",align:\"center\",\"show-overflow-tooltip\":\"\",\"min-width\":\"110\"}}),l(\"el-table-column\",{attrs:{prop:\"os\",label:\"操作系统\",align:\"center\",\"min-width\":\"110\",\"show-overflow-tooltip\":\"\"}}),l(\"el-table-column\",{attrs:{prop:\"browser\",label:\"浏览器\",align:\"center\",\"show-overflow-tooltip\":\"\",\"min-width\":\"110\"}}),l(\"el-table-column\",{attrs:{prop:\"type\",label:\"操作类型\",align:\"center\",\"min-width\":\"110\",\"show-overflow-tooltip\":\"\"},scopedSlots:e._u([{key:\"default\",fn:function(e){var t=e.row;return[l(\"ele-dot\",{attrs:{type:[\"\",\"success\",\"warning\"][t.type-1],ripple:0===t.type,text:[\"登录系统\",\"注销系统\",\"刷新TOKEN\"][t.type-1]}})]}}],null,!0)}),l(\"el-table-column\",{attrs:{prop:\"status\",label:\"状态\",align:\"center\",\"min-width\":\"100\",\"show-overflow-tooltip\":\"\"},scopedSlots:e._u([{key:\"default\",fn:function(e){var t=e.row;return[l(\"ele-dot\",{attrs:{type:[\"success\",\"danger\"][t.status],ripple:0===t.status,text:[\"成功\",\"失败\"][t.status]}})]}}],null,!0)}),l(\"el-table-column\",{attrs:{prop:\"note\",label:\"备注\",align:\"center\",\"show-overflow-tooltip\":\"\",\"min-width\":\"110\"}}),l(\"el-table-column\",{attrs:{prop:\"createTime\",label:\"登录时间\",align:\"center\",\"min-width\":\"160\",\"show-overflow-tooltip\":\"\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var l=t.row;return[e._v(e._s(e._f(\"toDateString\")(l.createTime)))]}}],null,!0)}),l(\"el-table-column\",{attrs:{label:\"操作\",width:\"100px\",align:\"center\",resizable:!1,fixed:\"right\"},scopedSlots:e._u([{key:\"default\",fn:function(t){var a=t.row;return[l(\"el-popconfirm\",{staticClass:\"ele-action\",attrs:{title:\"确定要删除此登录日志吗？\"},on:{confirm:function(t){return e.remove(a)}}},[e.permission.includes(\"sys:loginlog:delete\")?l(\"el-link\",{attrs:{slot:\"reference\",icon:\"el-icon-delete\",type:\"danger\",underline:!1},slot:\"reference\"},[e._v(\"删除\")]):e._e()],1)]}}],null,!0)})]}}])})],1)],1)},o=[],n=(l(\"4160\"),l(\"d81d\"),l(\"159b\"),l(\"5530\")),r=l(\"1146\"),s=l.n(r),i=l(\"2f62\"),c={name:\"SysLoginRecord\",data:function(){return{table:{url:\"/loginlog/index\",where:{}},daterange:\"\",pickerOptions:{shortcuts:[{text:\"最近一周\",onClick:function(e){var t=new Date,l=new Date;l.setTime(l.getTime()-6048e5),e.$emit(\"pick\",[l,t])}},{text:\"最近一个月\",onClick:function(e){var t=new Date,l=new Date;l.setTime(l.getTime()-2592e6),e.$emit(\"pick\",[l,t])}},{text:\"最近三个月\",onClick:function(e){var t=new Date,l=new Date;l.setTime(l.getTime()-7776e6),e.$emit(\"pick\",[l,t])}}]}}},computed:Object(n[\"a\"])({},Object(i[\"b\"])([\"permission\"])),methods:{onDateRangeChoose:function(){this.daterange?(this.table.where.createTimeStart=this.daterange[0],this.table.where.createTimeEnd=this.daterange[1]):(this.table.where.createTimeStart=null,this.table.where.createTimeEnd=null)},exportData:function(){var e=this,t=[[\"登录账号\",\"用户姓名\",\"IP地址\",\"设备型号\",\"操作系统\",\"浏览器\",\"操作类型\",\"备注\",\"登录时间\"]],l=this.$loading({lock:!0});this.$http.get(\"/loginlog/index?page=1&limit=2000\").then((function(a){if(l.close(),0===a.data.code){a.data.data.records.forEach((function(l){t.push([l.username,l.realname,l.loginIp,l.device,l.os,l.browser,[\"登录成功\",\"登录失败\",\"退出登录\",\"刷新TOKEN\"][l.type],l.note,e.$util.toDateString(l.createTime)])}));var o=s.a.utils.aoa_to_sheet(t);e.$util.exportSheet(s.a,o,\"登录日志\")}else e.$message.error(a.data.msg)})).catch((function(t){l.close(),e.$message.error(t.message)}))},remove:function(e){var t=this;if(e){var l=this.$loading({lock:!0});this.$http.delete(\"/loginlog/delete/\"+[e.id]).then((function(e){l.close(),0===e.data.code?(t.$message({type:\"success\",message:e.data.msg}),t.$refs.table.reload()):t.$message.error(e.data.msg)})).catch((function(e){l.close(),t.$message.error(e.message)}))}else{if(0===this.choose.length)return this.$message.error(\"请至少选择一条数据\");var a=this.choose.map((function(e){return e.id}));this.$confirm(\"确定要删除选中的登录日志吗?\",\"提示\",{type:\"warning\"}).then((function(){var e=t.$loading({lock:!0});t.$http.delete(\"/loginlog/delete/\"+a).then((function(l){e.close(),0===l.data.code?(t.$message({type:\"success\",message:l.data.msg}),t.$refs.table.reload()):t.$message.error(l.data.msg)})).catch((function(l){e.close(),t.$message.error(l.message)}))})).catch((function(){return 0}))}}}},u=c,d=l(\"0c7c\"),p=Object(d[\"a\"])(u,a,o,!1,null,\"4dfa6151\",null);t[\"default\"]=p.exports}}]);","extractedComments":[]}