{"remainingRequest":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\JavaWebVue\\javaweb-ui\\src\\components\\uploadImage.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\JavaWebVue\\javaweb-ui\\src\\components\\uploadImage.vue","mtime":1616814066000},{"path":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JavaWebVue\\javaweb-ui\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZmluaXNoX3Jvb20gewogIC8qd2lkdGg6IDE0MHB4OyovCiAgLypoZWlnaHQ6IDE2NXB4OyovCn0KCmltZyB7CiAgaGVpZ2h0OiAxMDAlOwp9CgouZmluaXNoX3Jvb20yIHsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDEwMCU7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGZsZXgtZmxvdzogd3JhcDsKfQoKLmZpbmlzaF9yb29tMiA+IGRpdiB7CiAgZGlzcGxheTogZmxleDsKICBmbGV4LXdyYXA6IHdyYXA7Cn0KCi5maW5pc2hfcm9vbTIgLm1hcmdlSW1nIHsKICBtYXJnaW4tbGVmdDogMTBweDsKfQoKLmZpbmlzaF9yb29tMiAucm9vbV9pbWcgewogIHdpZHRoOiAxMDBweDsKICBoZWlnaHQ6IDEwMHB4OwogIGN1cnNvcjogcG9pbnRlcjsKICBvdmVyZmxvdzogaGlkZGVuOwogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjUpOwogIG1hcmdpbi1sZWZ0OiAxMHB4OwogIG1hcmdpbi10b3A6IDEwcHg7Cn0KCi5maW5pc2hfcm9vbTIgLnJvb21faW1nOmJlZm9yZSB7CiAgLypjb250ZW50OiAiIjsqLwogIC8qd2lkdGg6IDA7Ki8KICAvKmhlaWdodDogMTAwJTsqLwogIC8qISpiYWNrZ3JvdW5kOiAjMDAwOyohKi8KICAvKnBhZGRpbmc6IDE0cHggMThweDsqLwogIC8qcG9zaXRpb246IGFic29sdXRlOyovCiAgLyp0b3A6IDA7Ki8KICAvKmxlZnQ6IDUwJTsqLwogIC8qb3BhY2l0eTogMDsqLwp9CgouZmluaXNoX3Jvb20yIC5yb29tX2ltZzpob3ZlcjpiZWZvcmUgewogIHdpZHRoOiAxMDAlOwogIGxlZnQ6IDA7CiAgb3BhY2l0eTogMC41Owp9CgouZmluaXNoX3Jvb20yIC5yb29tX2ltZyAuYm94LWNvbnRlbnQgewogIHdpZHRoOiAxMDAlOwogIHBhZGRpbmc6IDE0cHggMThweDsKICBjb2xvcjogI2ZmZjsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAzOCU7CiAgbGVmdDogMDsKfQoKLmZpbmlzaF9yb29tMiAucm9vbV9pbWcgLmljb24gewogIHBhZGRpbmc6IDA7CiAgbWFyZ2luOiAwOwogIGxpc3Qtc3R5bGU6IG5vbmU7CiAgbWFyZ2luLXRvcDogLTIwcHg7Cn0KCi5maW5pc2hfcm9vbTIgLnJvb21faW1nIC5pY29uIGxpIHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Cn0KCi5maW5pc2hfcm9vbTIgLnJvb21faW1nIC5pY29uIGxpIGkgewogIGRpc3BsYXk6IGJsb2NrOwogIHdpZHRoOiA0MHB4OwogIGhlaWdodDogNDBweDsKICBsaW5lLWhlaWdodDogNDBweDsKICBib3JkZXItcmFkaXVzOiA1MCU7CiAgZm9udC1zaXplOiAyMHB4OwogIGZvbnQtd2VpZ2h0OiA3MDA7CiAgY29sb3I6ICNmZmY7CiAgbWFyZ2luLXJpZ2h0OiAyNXB4OwogIG9wYWNpdHk6IDA7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDUwcHgpOwogIHRyYW5zaXRpb246IGFsbCAwLjVzIGVhc2UgMHM7Cn0KCkBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1heC13aWR0aDogOTkwcHgpIHsKICAuZmluaXNoX3Jvb20yIC5yb29tX2ltZyB7CiAgfQp9CgouZmluaXNoX3Jvb20yIC5kZWxldGVJbWcgewogIGNvbG9yOiByZWQ7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMHB4OwogIGxlZnQ6IDgwcHg7CiAgY3Vyc29yOiBwb2ludGVyOwp9CgouZmluaXNoX3Jvb20yIC5yb29tX2ltZyBpbWcgewogIGN1cnNvcjogcG9pbnRlcjsKICB3aWR0aDogMTAwcHg7CiAgaGVpZ2h0OiAxMDBweDsKfQoKLmZpbmlzaF9yb29tMiA+IC5yb29tX2ltZyBzcGFuIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgd2lkdGg6IGF1dG87CiAgaGVpZ2h0OiBhdXRvOwogIHJpZ2h0OiA1cHg7CiAgYm90dG9tOiAzcHg7Cn0KCi5maW5pc2hfcm9vbTIgLmltLWJ1dHRvbiB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogLTE0cHg7CiAgcmlnaHQ6IC0xOHB4OwogIHdpZHRoOiA0MHB4OwogIGhlaWdodDogNDBweDsKICBjdXJzb3I6IHBvaW50ZXI7CiAgYm9yZGVyLXJhZGl1czogNTAlOwogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC41KTsKICBvcGFjaXR5OiAwOwp9CgouZmluaXNoX3Jvb20yIC5yb29tX2ltZzpob3ZlciAuaWNvbiBsaSBpIHsKICBvcGFjaXR5OiAwLjU7Cn0KCi5maW5pc2hfcm9vbTIgLnJvb21faW1nOmhvdmVyIGltZyB7CiAgb3BhY2l0eTogMC41Owp9CgouZmluaXNoX3Jvb20yIC5yb29tX2ltZzpob3ZlciAuaW0tYnV0dG9uIHsKICBvcGFjaXR5OiAxOwp9CgouZmluaXNoX3Jvb20yIC5pbS1jbG9zZSB7CiAgdHJhbnNmb3JtOiByb3RhdGUoLTQ1ZGVnKTsKICBsaW5lLWhlaWdodDogMHB4OwogIGxlZnQ6IDZweDsKICBib3R0b206IDEzcHg7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHdpZHRoOiAxNXB4OwogIGhlaWdodDogMnB4OwogIGJhY2tncm91bmQ6ICNmZmY7CiAgcG9zaXRpb246IGFic29sdXRlOwp9CgouZmluaXNoX3Jvb20yIC5pbS1jbG9zZTEgewogIGxlZnQ6IDVweDsKICBib3R0b206IDEzcHg7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHdpZHRoOiAxNXB4OwogIGhlaWdodDogMnB4OwogIGJhY2tncm91bmQ6ICNmZmY7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRyYW5zZm9ybTogcm90YXRlKDQ1ZGVnKTsKfQoKLnJvb21fYWRkX2ltZyB7CiAgbWFyZ2luLWxlZnQ6IDEwcHg7CiAgbWFyZ2luLXRvcDogMTBweDsKICB3aWR0aDogMTAwcHg7CiAgaGVpZ2h0OiAxMDBweDsKICBjdXJzb3I6IHBvaW50ZXI7CiAgYm9yZGVyOiAxcHggc29saWQgI2UxZTFlMTsKICBkaXNwbGF5OiBmbGV4OwogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIHotaW5kZXg6IDEwOwp9Cgoucm9vbV9hZGRfaW1nID4gc3BhbjpudGgtY2hpbGQoMSkgewogIHdpZHRoOiAzMHB4OwogIGhlaWdodDogMzBweDsKICBvdmVyZmxvdzogaGlkZGVuOwp9Cgoucm9vbV9hZGRfaW1nID4gc3BhbjpudGgtY2hpbGQoMikgewogIG1hcmdpbi1ib3R0b206IDEwcHg7Cn0KCi5yb29tX2FkZF9pbWcgaW5wdXQgewogIGN1cnNvcjogcG9pbnRlcjsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAwcHg7CiAgbGVmdDogMHB4OwogIHdpZHRoOiAxMDAlOwogIGhlaWdodDogMTAwJTsKICB6LWluZGV4OiA5OTk5OTsKICBvcGFjaXR5OiAwOwp9Cg=="},{"version":3,"sources":["uploadImage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoNA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"uploadImage.vue","sourceRoot":"src/components","sourcesContent":["<template ref=\"uploadImage\">\n  <div class=\"finish_room\">\n    <div class=\"finish_room2\">\n      <div :images=\"photo\">\n        <div :key=\"index\" v-for=\"(item, index) in photo\" class=\"room_img\">\n          <img v-lazy=\"typeof item == 'string' ? item : item.url\" />\n          <div v-if=\"!disabled\" @click=\"deleteImg(index)\" class=\"im-button\">\n            <div class=\"im-close\"></div>\n            <div class=\"im-close1\"></div>\n          </div>\n        </div>\n      </div>\n      <div v-if=\"photo.length < limit\" v-loading=\"loading\" class=\"room_add_img\">\n        <span style=\"margin-top: 35px\"\n          ><img src=\"../assets/add_img.png\"\n        /></span>\n        <input :disabled=\"disabled\" @change=\"add_img\" type=\"file\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport default {\n  props: {\n    limit: {\n      type: Number,\n      default() {\n        return 1;\n      },\n    },\n    updDir: {\n      type: String,\n      default() {\n        return \"error\";\n      },\n    },\n    disabled: {\n      type: Boolean,\n      default() {\n        return false;\n      },\n    },\n    isCompress: {\n      type: Boolean,\n      default() {\n        return false;\n      },\n    },\n    value: {\n      type: [Array, String],\n      default() {\n        return [];\n      },\n    },\n  },\n  data: function () {\n    return {\n      photo: [],\n      loading: false,\n    };\n  },\n  watch: {\n    photo() {\n      if (this.limit == 1) {\n        this.$emit(\"input\", this.photo.length > 0 ? this.photo[0].url : \"\");\n      } else {\n        this.$emit(\"input\", this.photo);\n      }\n    },\n    value() {\n      if (this.limit == 1) {\n        if (this.value instanceof Array) {\n          this.photo = [];\n        } else {\n          this.photo = this.value ? [{ url: this.value }] : [];\n        }\n      } else {\n        // this.photo = this.value\n        // let photos=this.value\n        // photos=photos.map(item=>{\n        //     if(typeof item=='string'){\n        //         return {fileName:\"\",url:item}\n        //     }else{\n        //         return item\n        //     }\n        // })\n        this.photo = this.value || [];\n      }\n      if (typeof this.photo == \"string\") {\n        this.photo = [this.photo];\n      }\n    },\n  },\n  mounted() {\n    if (this.limit == 1) {\n      if (this.value instanceof Array) {\n        this.photo = [];\n      } else {\n        this.photo = this.value ? [this.value] : [];\n      }\n    } else {\n      // let photos=this.value\n      //     photos=photos.map(item=>{\n      //         if(typeof item=='string'){\n      //             return {fileName:\"\",url:item}\n      //         }else{\n      //             return item\n      //         }\n      //     })\n      //     this.photo=photos\n      this.photo = this.value || [];\n    }\n    if (typeof this.photo == \"string\") {\n      this.photo = [this.photo];\n    }\n  },\n  methods: {\n    deleteImg(index) {\n      this.photo.splice(index, 1);\n    },\n    compress(img) {\n      var url = null;\n      var canvas = document.createElement(\"canvas\");\n      var scale = img.height / img.width;\n      canvas.width = 720;\n      canvas.height = 720 * scale;\n\n      var ctx = canvas.getContext(\"2d\");\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n      url = canvas.toDataURL(\"image/jpeg\");\n      return url;\n    },\n    dataURItoBlob(dataURI) {\n      let byteString = window.atob(dataURI.split(\",\")[1]);\n      let mimeString = dataURI.split(\",\")[0].split(\":\")[1].split(\";\")[0];\n      let ab = new ArrayBuffer(byteString.length);\n      let ia = new Uint8Array(ab);\n      for (let i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i);\n      }\n      return new window.Blob([ab], { type: mimeString });\n    },\n    add_img(event) {\n      let file = event.target.files[0];\n      if (/\\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(event.target.value)) {\n        let MAXSIZE = 10 * 1024 * 1024;\n        let size = file.size;\n        if (size > MAXSIZE) {\n          event.target.value = \"\";\n          this.$notify.error({\n            title: \"上传图片错误\",\n            message: \"上传图片不能超过10M\",\n          });\n          return;\n        }\n        this.loading = true;\n        let reader = new FileReader();\n        let self = this;\n        reader.readAsDataURL(file);\n        let img = new Image();\n        let updDir = this.updDir;\n        reader.onload = function (e) {\n          img.src = this.result;\n          img.onload = function () {\n            let base = e.target.result;\n            let fileItem = file;\n            if (self.isCompress) {\n              base = self.compress(img);\n              fileItem = self.dataURItoBlob(base);\n            }\n            let formdata = new window.FormData();\n            formdata.append(\"file\", fileItem);\n            axios({\n              method: \"POST\",\n              url: \"/upload/uploadImage/\" + updDir,\n              data: formdata,\n              timeout: 1000000,\n              headers: {\n                \"Content-Type\": \"multipart/form-data\",\n              },\n            })\n              .then((res) => {\n                event.target.value = \"\";\n                self.photo.push({\n                  fileName: file.fileName,\n                  url: res.data.data,\n                });\n                self.loading = false;\n              })\n              .catch((e) => {\n                event.target.value = \"\";\n                self.loading = false;\n                this.$message.error(e.message);\n              });\n          };\n        };\n      } else {\n        event.target.value = \"\";\n        this.$notify.error({\n          title: \"上传图片错误\",\n          message: \"请上传gif|jpg|jpeg|png|GIF|JPG|PNG格式图片\",\n        });\n      }\n    },\n  },\n};\n</script>\n<style>\n.finish_room {\n  /*width: 140px;*/\n  /*height: 165px;*/\n}\n\nimg {\n  height: 100%;\n}\n\n.finish_room2 {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  flex-flow: wrap;\n}\n\n.finish_room2 > div {\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.finish_room2 .margeImg {\n  margin-left: 10px;\n}\n\n.finish_room2 .room_img {\n  width: 100px;\n  height: 100px;\n  cursor: pointer;\n  overflow: hidden;\n  position: relative;\n  text-align: center;\n  background-color: rgba(0, 0, 0, 0.5);\n  margin-left: 10px;\n  margin-top: 10px;\n}\n\n.finish_room2 .room_img:before {\n  /*content: \"\";*/\n  /*width: 0;*/\n  /*height: 100%;*/\n  /*!*background: #000;*!*/\n  /*padding: 14px 18px;*/\n  /*position: absolute;*/\n  /*top: 0;*/\n  /*left: 50%;*/\n  /*opacity: 0;*/\n}\n\n.finish_room2 .room_img:hover:before {\n  width: 100%;\n  left: 0;\n  opacity: 0.5;\n}\n\n.finish_room2 .room_img .box-content {\n  width: 100%;\n  padding: 14px 18px;\n  color: #fff;\n  position: absolute;\n  top: 38%;\n  left: 0;\n}\n\n.finish_room2 .room_img .icon {\n  padding: 0;\n  margin: 0;\n  list-style: none;\n  margin-top: -20px;\n}\n\n.finish_room2 .room_img .icon li {\n  display: inline-block;\n}\n\n.finish_room2 .room_img .icon li i {\n  display: block;\n  width: 40px;\n  height: 40px;\n  line-height: 40px;\n  border-radius: 50%;\n  font-size: 20px;\n  font-weight: 700;\n  color: #fff;\n  margin-right: 25px;\n  opacity: 0;\n  transform: translateY(50px);\n  transition: all 0.5s ease 0s;\n}\n\n@media only screen and (max-width: 990px) {\n  .finish_room2 .room_img {\n  }\n}\n\n.finish_room2 .deleteImg {\n  color: red;\n  position: absolute;\n  top: 0px;\n  left: 80px;\n  cursor: pointer;\n}\n\n.finish_room2 .room_img img {\n  cursor: pointer;\n  width: 100px;\n  height: 100px;\n}\n\n.finish_room2 > .room_img span {\n  position: absolute;\n  width: auto;\n  height: auto;\n  right: 5px;\n  bottom: 3px;\n}\n\n.finish_room2 .im-button {\n  position: absolute;\n  top: -14px;\n  right: -18px;\n  width: 40px;\n  height: 40px;\n  cursor: pointer;\n  border-radius: 50%;\n  background-color: rgba(0, 0, 0, 0.5);\n  opacity: 0;\n}\n\n.finish_room2 .room_img:hover .icon li i {\n  opacity: 0.5;\n}\n\n.finish_room2 .room_img:hover img {\n  opacity: 0.5;\n}\n\n.finish_room2 .room_img:hover .im-button {\n  opacity: 1;\n}\n\n.finish_room2 .im-close {\n  transform: rotate(-45deg);\n  line-height: 0px;\n  left: 6px;\n  bottom: 13px;\n  display: inline-block;\n  width: 15px;\n  height: 2px;\n  background: #fff;\n  position: absolute;\n}\n\n.finish_room2 .im-close1 {\n  left: 5px;\n  bottom: 13px;\n  display: inline-block;\n  width: 15px;\n  height: 2px;\n  background: #fff;\n  position: absolute;\n  transform: rotate(45deg);\n}\n\n.room_add_img {\n  margin-left: 10px;\n  margin-top: 10px;\n  width: 100px;\n  height: 100px;\n  cursor: pointer;\n  border: 1px solid #e1e1e1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: space-between;\n  position: relative;\n  z-index: 10;\n}\n\n.room_add_img > span:nth-child(1) {\n  width: 30px;\n  height: 30px;\n  overflow: hidden;\n}\n\n.room_add_img > span:nth-child(2) {\n  margin-bottom: 10px;\n}\n\n.room_add_img input {\n  cursor: pointer;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n  z-index: 99999;\n  opacity: 0;\n}\n</style>\n"]}]}