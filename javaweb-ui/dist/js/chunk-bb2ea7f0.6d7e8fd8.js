(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bb2ea7f0"],{"161d":function(e,t,l){"use strict";l("cb55")},"206d":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAAXNSR0IArs4c6QAAAJ5JREFUWAnt2DEKwDAMA8Ck9Cl9e/Ko9i8uXrUIBQ8eVMhgUEW4Zggdo+jZe7+5iurGXVUUEU9VV/ZclWWVXd6Yqmkxi6kCat5nzGKqgJr3GbOYKqDm256xmbfO6kueqoP5OefXVgw3ezyvtSLXcQG82FbMG4MvRUeLUSIIWAxA6GgxSgQBiwEIHS1GiSBgMQChY1uxsn+weR2mDELgB3FmFp5YffVrAAAAAElFTkSuQmCC"},"5cc6":function(e,t,l){var o=l("74e8");o("Uint8",(function(e){return function(t,l,o){return e(this,t,l,o)}}))},"6e18":function(e,t,l){},c19f:function(e,t,l){"use strict";var o=l("23e7"),a=l("da84"),r=l("621a"),i=l("2626"),s="ArrayBuffer",n=r[s],c=a[s];o({global:!0,forced:c!==n},{ArrayBuffer:n}),i(s)},cb55:function(e,t,l){},cbc3:function(e,t,l){"use strict";var o=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"finish_room"},[l("div",{staticClass:"finish_room2"},[l("div",{attrs:{images:e.photo}},e._l(e.photo,(function(t,o){return l("div",{key:o,staticClass:"room_img"},[l("img",{directives:[{name:"lazy",rawName:"v-lazy",value:"string"==typeof t?t:t.url,expression:"typeof item == 'string' ? item : item.url"}]}),e.disabled?e._e():l("div",{staticClass:"im-button",on:{click:function(t){return e.deleteImg(o)}}},[l("div",{staticClass:"im-close"}),l("div",{staticClass:"im-close1"})])])})),0),e.photo.length<e.limit?l("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"room_add_img"},[e._m(0),l("input",{attrs:{disabled:e.disabled,type:"file"},on:{change:e.add_img}})]):e._e()])])},a=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("span",{staticStyle:{"margin-top":"35px"}},[o("img",{attrs:{src:l("206d")}})])}],r=(l("a434"),l("c19f"),l("a9e3"),l("d3b7"),l("ac1f"),l("1276"),l("5cc6"),l("9a8c"),l("a975"),l("735e"),l("c1ac"),l("d139"),l("3a7b"),l("d5d6"),l("82f8"),l("e91f"),l("60bd"),l("5f96"),l("3280"),l("3fcc"),l("ca91"),l("25a1"),l("cd26"),l("3c5d"),l("2954"),l("649e"),l("219c"),l("170b"),l("b39a"),l("72f7"),l("bc3a")),i=l.n(r),s={props:{limit:{type:Number,default:function(){return 1}},updDir:{type:String,default:function(){return"error"}},disabled:{type:Boolean,default:function(){return!1}},isCompress:{type:Boolean,default:function(){return!1}},value:{type:[Array,String],default:function(){return[]}}},data:function(){return{photo:[],loading:!1}},watch:{photo:function(){1==this.limit?this.$emit("input",this.photo.length>0?this.photo[0].url:""):this.$emit("input",this.photo)},value:function(){1==this.limit?this.value instanceof Array?this.photo=[]:this.photo=this.value?[{url:this.value}]:[]:this.photo=this.value||[],"string"==typeof this.photo&&(this.photo=[this.photo])}},mounted:function(){1==this.limit?this.value instanceof Array?this.photo=[]:this.photo=this.value?[this.value]:[]:this.photo=this.value||[],"string"==typeof this.photo&&(this.photo=[this.photo])},methods:{deleteImg:function(e){this.photo.splice(e,1)},compress:function(e){var t=null,l=document.createElement("canvas"),o=e.height/e.width;l.width=720,l.height=720*o;var a=l.getContext("2d");return a.clearRect(0,0,l.width,l.height),a.drawImage(e,0,0,l.width,l.height),t=l.toDataURL("image/jpeg"),t},dataURItoBlob:function(e){for(var t=window.atob(e.split(",")[1]),l=e.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(t.length),a=new Uint8Array(o),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return new window.Blob([o],{type:l})},add_img:function(e){var t=e.target.files[0];if(/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(e.target.value)){var l=10485760,o=t.size;if(o>l)return e.target.value="",void this.$notify.error({title:"上传图片错误",message:"上传图片不能超过10M"});this.loading=!0;var a=new FileReader,r=this;a.readAsDataURL(t);var s=new Image,n=this.updDir;a.onload=function(l){s.src=this.result,s.onload=function(){var o=this,a=l.target.result,c=t;r.isCompress&&(a=r.compress(s),c=r.dataURItoBlob(a));var d=new window.FormData;d.append("file",c),i()({method:"POST",url:"/upload/uploadImage/"+n,data:d,timeout:1e6,headers:{"Content-Type":"multipart/form-data"}}).then((function(l){e.target.value="",r.photo.push({fileName:t.fileName,url:l.data.data}),r.loading=!1})).catch((function(t){e.target.value="",r.loading=!1,o.$message.error(t.message)}))}}}else e.target.value="",this.$notify.error({title:"上传图片错误",message:"请上传gif|jpg|jpeg|png|GIF|JPG|PNG格式图片"})}}},n=s,c=(l("f960"),l("0c7c")),d=Object(c["a"])(n,o,a,!1,null,null,null);t["a"]=d.exports},d267:function(e,t,l){"use strict";l.r(t);var o=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"ele-body"},[l("el-card",{attrs:{shadow:"never"}},[l("el-form",{staticClass:"ele-form-search",attrs:{model:e.table.where,"label-width":"90px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$refs.table.reload()},submit:function(e){e.preventDefault()}}},[l("el-row",{attrs:{gutter:15}},[l("el-col",{attrs:{md:6,sm:12}},[l("el-form-item",{attrs:{label:"广告标题:"}},[l("el-input",{attrs:{placeholder:"请输入广告标题",clearable:""},model:{value:e.table.where.title,callback:function(t){e.$set(e.table.where,"title",t)},expression:"table.where.title"}})],1)],1),l("el-col",{attrs:{md:6,sm:12}},[l("div",{staticClass:"ele-form-actions"},[l("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.$refs.table.reload()}}},[e._v("查询 ")]),l("el-button",{on:{click:function(t){(e.table.where={})&&e.$refs.table.reload()}}},[e._v("重置")])],1)])],1)],1),l("div",{staticClass:"ele-table-tool ele-table-tool-default"},[e.permission.includes("sys:ad:add")?l("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){e.showEdit=!0}}},[e._v("添加 ")]):e._e(),e.permission.includes("sys:ad:dall")?l("el-button",{staticClass:"ele-btn-icon",attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(t){return e.remove()}}},[e._v("批量删除 ")]):e._e()],1),l("ele-data-table",{ref:"table",attrs:{config:e.table,choose:e.choose,height:"calc(100vh - 315px)","highlight-current-row":""},on:{"update:choose":function(t){e.choose=t}},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.index;return[l("el-table-column",{attrs:{type:"selection",width:"45",align:"center",fixed:"left"}}),l("el-table-column",{attrs:{type:"index",index:o,label:"编号",width:"60",align:"center",fixed:"left","show-overflow-tooltip":""}}),l("el-table-column",{attrs:{prop:"title",label:"广告标题",sortable:"custom","show-overflow-tooltip":"","min-width":"200"}}),l("el-table-column",{attrs:{prop:"adSortName",label:"所属广告位",sortable:"custom","show-overflow-tooltip":"","min-width":"200"}}),l("el-table-column",{attrs:{label:"广告封面","min-width":"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[l("el-avatar",{attrs:{shape:"square",size:25,src:t.cover}})]}}],null,!0)}),l("el-table-column",{attrs:{label:"广告类型","min-width":"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[l("el-tag",{attrs:{type:["","primary","success","warning"][o.type-1],size:"mini"}},[e._v(e._s(["图片","文字","视频","推荐"][o.type-1]))])]}}],null,!0)}),l("el-table-column",{attrs:{prop:"description",label:"广告描述","show-overflow-tooltip":"","min-width":"200",align:"center"}}),l("el-table-column",{attrs:{prop:"url",label:"广告地址","show-overflow-tooltip":"","min-width":"200",align:"center"}}),l("el-table-column",{attrs:{label:"广告尺寸","show-overflow-tooltip":"","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[e._v(e._s(l.width)+" x "+e._s(l.height))]}}],null,!0)}),l("el-table-column",{attrs:{prop:"startTime",label:"广告开始时间","show-overflow-tooltip":"","min-width":"160",align:"center"}}),l("el-table-column",{attrs:{prop:"endTime",label:"广告结束时间","show-overflow-tooltip":"","min-width":"160",align:"center"}}),l("el-table-column",{attrs:{prop:"viewNum",label:"点击率","show-overflow-tooltip":"","min-width":"100",align:"center"}}),l("el-table-column",{attrs:{prop:"status",label:"状态",sortable:"","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[l("ele-dot",{attrs:{type:["danger","success"][t.status],ripple:0===t.status,text:["禁用","正常"][t.status]}})]}}],null,!0)}),l("el-table-column",{attrs:{prop:"sort",label:"排序",sortable:"custom","show-overflow-tooltip":""}}),l("el-table-column",{attrs:{label:"创建时间",sortable:"custom","show-overflow-tooltip":"","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[e._v(e._s(e._f("toDateString")(l.createTime)))]}}],null,!0)}),l("el-table-column",{attrs:{label:"更新时间",sortable:"custom","show-overflow-tooltip":"","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[e._v(e._s(e._f("toDateString")(l.updateTime)))]}}],null,!0)}),l("el-table-column",{attrs:{label:"操作",width:"130px",align:"center",resizable:!1,fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[e.permission.includes("sys:ad:edit")?l("el-link",{attrs:{icon:"el-icon-edit",type:"primary",underline:!1},on:{click:function(t){return e.edit(o)}}},[e._v("修改")]):e._e(),l("el-popconfirm",{staticClass:"ele-action",attrs:{title:"确定要删除此广告吗？"},on:{confirm:function(t){return e.remove(o)}}},[e.permission.includes("sys:ad:delete")?l("el-link",{attrs:{slot:"reference",icon:"el-icon-delete",type:"danger",underline:!1},slot:"reference"},[e._v("删除")]):e._e()],1)]}}],null,!0)})]}}])})],1),l("el-dialog",{attrs:{title:(e.editForm.id,"修改广告"),visible:e.showEdit,width:"700px","destroy-on-close":!0,"custom-class":"ele-dialog-form","lock-scroll":!1},on:{"update:visible":function(t){e.showEdit=t},closed:function(t){e.editForm={}}}},[l("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editRules,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"广告图片:"}},[l("uploadImage",{attrs:{limit:1,updDir:e.updDir},model:{value:e.editForm.cover,callback:function(t){e.$set(e.editForm,"cover",t)},expression:"editForm.cover"}})],1),l("el-row",{attrs:{gutter:15}},[l("el-col",{attrs:{sm:12}},[l("el-form-item",{attrs:{label:"广告标题:",prop:"title"}},[l("el-input",{attrs:{placeholder:"请输入广告标题",clearable:""},model:{value:e.editForm.title,callback:function(t){e.$set(e.editForm,"title",t)},expression:"editForm.title"}})],1),l("el-form-item",{attrs:{label:"广告类型:",prop:"type"}},[l("el-select",{staticClass:"ele-block",attrs:{placeholder:"请选择广告类型",clearable:""},model:{value:e.editForm.type,callback:function(t){e.$set(e.editForm,"type",t)},expression:"editForm.type"}},[l("el-option",{attrs:{label:"图片",value:1}}),l("el-option",{attrs:{label:"文字",value:2}}),l("el-option",{attrs:{label:"视频",value:3}}),l("el-option",{attrs:{label:"其他",value:4}})],1)],1),l("el-form-item",{attrs:{label:"广告URL:",prop:"url"}},[l("el-input",{attrs:{placeholder:"请输入广告URL",clearable:""},model:{value:e.editForm.url,callback:function(t){e.$set(e.editForm,"url",t)},expression:"editForm.url"}})],1),l("el-form-item",{attrs:{label:"广告宽度:",prop:"width"}},[l("el-input",{attrs:{placeholder:"请输入广告宽度",clearable:""},model:{value:e.editForm.width,callback:function(t){e.$set(e.editForm,"width",t)},expression:"editForm.width"}})],1),l("el-form-item",{attrs:{label:"开始时间:",prop:"startTime"}},[l("el-date-picker",{attrs:{type:"datetime",placeholder:"选择开始时间",size:"small"},model:{value:e.editForm.startTime,callback:function(t){e.$set(e.editForm,"startTime",t)},expression:"editForm.startTime"}})],1),l("el-form-item",{attrs:{label:"排序号:",prop:"sort"}},[l("el-input-number",{staticClass:"ele-fluid ele-text-left",attrs:{"controls-position":"right",min:0,placeholder:"请输入排序号"},model:{value:e.editForm.sort,callback:function(t){e.$set(e.editForm,"sort",t)},expression:"editForm.sort"}})],1)],1),l("el-col",{attrs:{sm:12}},[l("el-form-item",{attrs:{label:"广告位",prop:"adSortId",rules:{required:!0,message:"所属广告位不能为空",trigger:"change"}}},[l("el-select",{staticClass:"ele-block",attrs:{filterable:"",clearable:"",size:"small",placeholder:"-请选择广告位-"},model:{value:e.editForm.adSortId,callback:function(t){e.$set(e.editForm,"adSortId",t)},expression:"editForm.adSortId"}},e._l(e.adSortList,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),l("el-form-item",{attrs:{label:"广告描述:",prop:"description"}},[l("el-input",{attrs:{placeholder:"请输入广告描述",clearable:""},model:{value:e.editForm.description,callback:function(t){e.$set(e.editForm,"description",t)},expression:"editForm.description"}})],1),l("el-form-item",{attrs:{label:"广告状态:"}},[l("el-radio-group",{model:{value:e.editForm.status,callback:function(t){e.$set(e.editForm,"status",t)},expression:"editForm.status"}},[l("el-radio",{attrs:{label:1}},[e._v("正常")]),l("el-radio",{attrs:{label:2}},[e._v("禁用")])],1)],1),l("el-form-item",{attrs:{label:"广告高度:",prop:"height"}},[l("el-input",{attrs:{placeholder:"请输入广告高度",clearable:""},model:{value:e.editForm.height,callback:function(t){e.$set(e.editForm,"height",t)},expression:"editForm.height"}})],1),l("el-form-item",{attrs:{label:"结束时间:",prop:"endTime"}},[l("el-date-picker",{attrs:{type:"datetime",placeholder:"选择结束时间",size:"small"},model:{value:e.editForm.endTime,callback:function(t){e.$set(e.editForm,"endTime",t)},expression:"editForm.endTime"}})],1)],1)],1)],1),l("div",{attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.showEdit=!1}}},[e._v("取消")]),l("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)],1)},a=[],r=(l("d81d"),l("5530")),i=l("cbc3"),s=l("2f62"),n={name:"SysAd",components:{uploadImage:i["a"]},data:function(){return{table:{url:"/ad/index",where:{}},choose:[],showEdit:!1,editForm:{status:1},editRules:{title:[{required:!0,message:"请输入广告标题",trigger:"blur"}],adSortId:[{required:!0,message:"请选择所属广告位",trigger:"blur"}],type:[{required:!0,message:"请选择广告类型",trigger:"blur"}],description:[{required:!0,message:"请输入广告描述",trigger:"blur"}],width:[{required:!0,message:"请输入广告宽度",trigger:"blur"}],height:[{required:!0,message:"请输入广告高速",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]},updDir:"ad",adSortList:[]}},computed:Object(r["a"])({},Object(s["b"])(["permission"])),mounted:function(){this.getAdSortList()},methods:{edit:function(e){this.editForm=Object.assign({},e),this.showEdit=!0},save:function(){var e=this;this.$refs["editForm"].validate((function(t){if(!t)return!1;var l=e.$loading({lock:!0});e.$http[e.editForm.id?"put":"post"](e.editForm.id?"/ad/edit":"/ad/add",e.editForm).then((function(t){l.close(),0===t.data.code?(e.showEdit=!1,e.$message({type:"success",message:t.data.msg}),e.$refs.table.reload()):e.$message.error(t.data.msg)})).catch((function(t){l.close(),e.$message.error(t.message)}))}))},remove:function(e){var t=this;if(e){var l=this.$loading({lock:!0});this.$http.delete("/ad/delete/"+[e.id]).then((function(e){l.close(),0===e.data.code?(t.$message({type:"success",message:e.data.msg}),t.$refs.table.reload()):t.$message.error(e.data.msg)})).catch((function(e){l.close(),t.$message.error(e.message)}))}else{if(0===this.choose.length)return this.$message.error("请至少选择一条数据");var o=this.choose.map((function(e){return e.id}));this.$confirm("确定要删除选中的广告吗?","提示",{type:"warning"}).then((function(){var e=t.$loading({lock:!0});t.$http.delete("/ad/delete/"+o).then((function(l){e.close(),0===l.data.code?(t.$message({type:"success",message:l.data.msg}),t.$refs.table.reload()):t.$message.error(l.data.msg)})).catch((function(l){e.close(),t.$message.error(l.message)}))})).catch((function(){return 0}))}},getAdSortList:function(){var e=this;this.$http.get("/adsort/getAdSortList").then((function(t){0===t.data.code?e.adSortList=t.data.data:e.$message.error(t.data.msg)})).catch((function(t){e.$message.error(t.message)}))}}},c=n,d=(l("161d"),l("0c7c")),u=Object(d["a"])(c,o,a,!1,null,"0dee5fac",null);t["default"]=u.exports},f960:function(e,t,l){"use strict";l("6e18")}}]);